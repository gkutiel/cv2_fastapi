<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebCam</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .info {
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
            font-size: 2em;
            width: 20em;
            font-family: 'Courier New', Courier, monospace;
        }

        #ears {
            width: 100%;
            display: flex;
            justify-content: space-between;
        }

        #crop {
            height: 300px;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div class="info">
        <div id="head_pose">
            <p id="yaw"></p>
            <p id="pitch"></p>
            <p id="roll"></p>
        </div>
        <div id="ears">
            <p id="left_ear"></p>
            <p id="right_ear"></p>
        </div>
    </div>
    <img id='vid' />
    <img id='crop' />
</body>

<script>
    const ws = new WebSocket("ws://localhost:8000/ws");

    const vid = document.getElementById('vid')
    const crop_img = document.getElementById('crop')
    const yaw_el = document.getElementById('yaw')
    const pitch_el = document.getElementById('pitch')
    const left_ear_el = document.getElementById('left_ear')
    const right_ear_el = document.getElementById('right_ear')


    ws.onmessage = (event) => {
        const { img, crop, ear_left, ear_right, yaw, pitch } = JSON.parse(event.data)

        yaw_el.innerText = `Yaw: ${yaw}`
        pitch_el.innerText = `Pitch: ${pitch}`
        left_ear_el.innerText = `Left ear: ${ear_left}`
        right_ear_el.innerText = `Right ear: ${ear_right}`

        vid.src = `data:image/jpg;base64,${img}`
        if (!crop) {
            crop_img.src = 'https://theawesomedaily.com/wp-content/uploads/2017/05/funny-faces-101.jpeg'
        } else {
            crop_img.src = `data:image/jpg;base64,${crop}`
        }
    };


</script>

</html>